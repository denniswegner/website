<!DOCTYPE html>

<html lang="en">

    <head>
        <meta charset="UTF-8">
        <title>Global Statistic TLS Handshake</title>
        <!-- Load c3.css -->
        <link href="js/c3-0.4.10/c3.css" rel="stylesheet" type="text/css">
        <!-- Load d3.js and c3.js -->
        <script src="js/c3-0.4.10/d3.min.js" charset="utf-8"></script>
        <script src="js/c3-0.4.10/c3.min.js"></script>
        <!-- JQuery CDN -->
        <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
        <script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
        <script type="text/javascript" src="js/filterData.js"></script>
        <!-- Stylesheets-->
        <link rel="stylesheet" href="css/statistics.css">
    </head>

    <script>
        // Code will be executed  once the entire page (images or iframes), not just the DOM, is ready.
        window.onload = function () {

            // Sample Data, this is ja required json format, that c3 requires
            var testdaten = {
                "dhe": [
                    {
                        "keysize": "256",
                        "size": 312,
                        "percent": 3,
                    },
                    {
                        "keysize": "512",
                        "size": 31232,
                        "percent": 12,
                    },
                    {
                        "keysize": "768",
                        "size": 6534,
                        "percent": 20, },
                    {
                        "keysize": "1024",
                        "size": 256434,
                        "percent": 80,
                    },
                    {
                        "keysize": "2048",
                        "size": 65100,
                        "percent": 15,
                    },
                ],
                "pfs": [
                    {
                        "PFS: ": "PFS enabled",
                        "amount": 80,
                    },
                    {
                        "PFS: ": "PFS disabled",
                        "amount": 80,
                    }
                ]

            };

            var test_array_JSONs = [
                {"PFS enabled": 80, "PFS Disabled": 20},
            ];

            /*
             * All in one Chart. 
             */
            var chart = c3.generate({
                bindto: '#chart',
                legend: {
                    show: true,
                },
                size: {
                    width: 640
                },
                data: {
                    labels: true,
                    type: 'bar',
                    json: testdaten.dhe,
                    keys: {
                        x: 'keysize',
                        value: ['size']
                    },
                },
                axis: {
                    x: {
                        type: 'category',
                    },
                },
                bar: {
                    width: {
                        ratio: 0.6
                    }
                },
                zoom: {
                    enabled: true
                },
            });

            /*
             * Load PFS-Pie-Chart function. 
             */

            $("#loadPFS").click(function ()
            {
                chart.load({
                    json: test_array_JSONs,
                    keys: {
                        value: ['PFS enabled', 'PFS Disabled']
                    },
                    type: 'pie',
                    unload: chart.columns,
                });
            }
            );

            /*
             * Load DHE-Parameter-Chart function with one Y-Axis. 
             */

            $("#loadDHEParameter").click(function ()
            {
                chart.load({
                    type: 'bar',
                    json: testdaten.dhe,
                    keys: {
                        x: 'keysize',
                        value: ['size']
                    },
                    unload: chart.columns,
                });
            }
            );

            // !! The following charts are only for test purposes !!
            // Second chart with multidimensinonal Array. I didn't figure out how we can use the additional y-axis 
            // in the first chart

            var charty2 = c3.generate({
                bindto: '#charty2',
                size: {
                    width: 640
                },
                data: {
                    columns: [
                        ['key-size', 634, 21254, 1432, 253542, 11343, 132543],
                        ['percent', 1, 10, 2, 80, 6, 20],
                    ],
                    type: 'bar',
                    types: {
                        percent: 'line',
                    },
                    axes: {
                        'percent': 'y2'
                    },
                },
                axis: {
                    x: {
                        type: 'category',
                        categories: ['256', '512', '768', '1024', '1536', '2048']
                    },
                    y: {
                        label: {
                            text: 'Counts',
                            position: 'outer-middle'
                        }
                    },
                    y2: {
                        show: true,
                        label: {
                            text: 'In percent',
                            position: 'outer-middle'
                        },
                        max: 100,
                        min: 0
                    }
                }


            });


            var donutChart = c3.generate({
                bindto: '#pie',
                data: {
                    json: test_array_JSONs,
                    keys: {
                        value: ['PFS enabled', 'PFS Disabled']
                    },
                    type: 'pie'
                }
            });




        };
    </script>

    <body>

        <div class="header">
            <ul class="headerMenu">
                <li><a href="index.html">Home</a></li>
                <li><a href="globaldata.html">Global Statistics</a></li>
                <li><a href="crawlDemand.html">Analyse Me</a></li>
            </ul>
        </div>
        <div class="content_wrapper">
            <div>
                <form id="filterBox" name="filterBox" action="js/filterData.js" method="POST" onsubmit="applyFilters()">
                    <fieldset>
                        <legend>Apply a Filter</legend>
                        <fieldset>
                            <legend>SSL / TLS Version</legend>
                            <input id="filterProtocol" list="ssl_tls" onblur="manageFilterSelection()" placeholder="Type something to get started!">
                            <datalist id="ssl_tls">
                                <option value="SSL 2.0">
                                <option value="SSL 3.0">
                                <option value="TLS 1.0">
                                <option value="TLS 1.1">
                                <option value="TLS 1.2">
                            </datalist>
                        </fieldset>
                        <fieldset>
                            <legend>Key Exchange and Authentication</legend>
                            <input id="filterKeyExAndAuth" list="keyExAuth">
                            <datalist id="keyExAuth">
                                <option value="RSA">
                                <option value="DH_RSA">
                                <option value="DHE_RSA">
                                <option value="ECDH_RSA">
                                <option value="ECDHE_RSA">
                                <option value="DH_DSS">
                                <option value="DHE_DSS">
                                <option value="ECDH_ECDSA">
                                <option value="ECDHE_ECDSA">
                                <option value="PSK">
                                <option value="PSK_RSA">
                                <option value="DHE_PSK">
                                <option value="ECDHE_PSK">
                                <option value="SRP">
                                <option value="SRP_DSS">
                                <option value="SRP_RSA">
                                <option value="KERBEROS">
                                <option value="DH_ANON">
                                <option value="ECDH_ANON">
                                <option value="GOST">
                            </datalist>
                        </fieldset>
                        <fieldset>
                            <legend>Bulk Cipher and Key Length (in bits)</legend>
                            <input id="filterCipher" list="cipher">
                            <datalist id="cipher">
                                <option value="AES_GCM">
                                <option value="AES_CCM">
                                <option value="AES_CBC">
                                <option value="CAMELLIA_GCM">
                                <option value="CAMELLIA_CBC">
                                <option value="ARIA_GCM">
                                <option value="ARIA_CBC">
                                <option value="SEED_CBC">
                                <option value="3DES_EDE_CBC">
                                <option value="GOST_28147-89_CNT">
                                <option value="IDEA_CBC">
                                <option value="DES_CBC">
                                <option value="RC2_CBC">
                                <option value="ChaCha_20-POLY1305">
                                <option value="RC4">
                                <option value="none">
                            </datalist>
                            <input id="filterKeyLen" list="keyLen">
                            <datalist id="keyLen">
                                <option value="40">
                                <option value="56">
                                <option value="112">
                                <option value="128">
                                <option value="256">
                            </datalist>
                        </fieldset>
                        <fieldset>
                            <legend>Message Authenticity</legend>
                            <input id="filterMsgAuth" list="msgAuth">
                            <datalist id="msgAuth">
                                <option value="MD5">
                                <option value="SHA1">
                                <option value="SHA256">
                                <option value="SHA384">
                                <option value="AEAD">
                                <option value="GOST_28147-89_IMIT">
                                <option value="GOST_R34.11-94">
                            </datalist>
                        </fieldset>
                        <fieldset>
                            <div id="filterButtons">
                                <input id="filterApply" type="submit" value="Apply Filter">
                                <input id="filterReset" type="reset" value="Reset Filter">
                            </div>
                        </fieldset>
                    </fieldset>
                </form>
            </div>
            <h2 >Which DHE parameter key-size do the TLS Server prefer?</h2>
            <div id="charts">
                <button id="loadPFS">PFS</button>
                <button id="loadDHEParameter">DHE-Parameter</button>
                <br>
                With 2 Y-axes
                <div id="charty2"></div>

                <h2>How many TLS-Server support perfect forward secrecy(PFS)?</h2>

                <div id="pie"></div>
            </div>

        </div>

    </body>

</html>
